SELECT SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 12 AND DATEDIFF(MONTH, dr, datevisit) < 18) AND RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g1, 
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 18 AND DATEDIFF(MONTH, dr, datevisit) < 21) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g1_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 21 AND DATEDIFF(MONTH, dr, datevisit) < 24) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g1_9,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 24 AND DATEDIFF(MONTH, dr, datevisit) < 30) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g2,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 30 AND DATEDIFF(MONTH, dr, datevisit) < 36) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g2_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 36 AND DATEDIFF(MONTH, dr, datevisit) < 42) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g3,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 42 AND DATEDIFF(MONTH, dr, datevisit) < 48) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g3_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 48 AND DATEDIFF(MONTH, dr, datevisit) < 60) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g4,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 60 AND DATEDIFF(MONTH, dr, datevisit) < 72) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g5,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 72 AND DATEDIFF(MONTH, dr, datevisit) < 84) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 84 AND DATEDIFF(MONTH, dr, datevisit) < 96) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g7,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 96 AND DATEDIFF(MONTH, dr, datevisit) < 108) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g8,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 108 AND DATEDIFF(MONTH, dr, datevisit) < 156) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g9,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 156 AND DATEDIFF(MONTH, dr, datevisit) < 192) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g13,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 192 AND DATEDIFF(MONTH, dr, datevisit) < 204) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g16,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 204 AND DATEDIFF(MONTH, dr, datevisit) < 216) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g17,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 216 AND DATEDIFF(MONTH, dr, datevisit) < 227) and RSLT in (317,321,327,332,337,343,347) THEN 1 ELSE 0 END) AS g18

	   ,SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 12 AND DATEDIFF(MONTH, dr, datevisit) < 18) AND RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g1, 
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 18 AND DATEDIFF(MONTH, dr, datevisit) < 21) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g1_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 21 AND DATEDIFF(MONTH, dr, datevisit) < 24) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g1_9,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 24 AND DATEDIFF(MONTH, dr, datevisit) < 30) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g2,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 30 AND DATEDIFF(MONTH, dr, datevisit) < 36) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g2_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 36 AND DATEDIFF(MONTH, dr, datevisit) < 42) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g3,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 42 AND DATEDIFF(MONTH, dr, datevisit) < 48) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g3_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 48 AND DATEDIFF(MONTH, dr, datevisit) < 60) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g4,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 60 AND DATEDIFF(MONTH, dr, datevisit) < 72) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g5,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 72 AND DATEDIFF(MONTH, dr, datevisit) < 84) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 84 AND DATEDIFF(MONTH, dr, datevisit) < 96) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g7,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 96 AND DATEDIFF(MONTH, dr, datevisit) < 108) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g8,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 108 AND DATEDIFF(MONTH, dr, datevisit) < 156) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g9,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 156 AND DATEDIFF(MONTH, dr, datevisit) < 192) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g13,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 192 AND DATEDIFF(MONTH, dr, datevisit) < 204) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g16,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 204 AND DATEDIFF(MONTH, dr, datevisit) < 216) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g17,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 216 AND DATEDIFF(MONTH, dr, datevisit) < 227) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g18

       ,SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 12 AND DATEDIFF(MONTH, dr, datevisit) < 18) AND RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g1, 
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 18 AND DATEDIFF(MONTH, dr, datevisit) < 21) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g1_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 21 AND DATEDIFF(MONTH, dr, datevisit) < 24) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g1_9,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 24 AND DATEDIFF(MONTH, dr, datevisit) < 30) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g2,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 30 AND DATEDIFF(MONTH, dr, datevisit) < 36) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g2_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 36 AND DATEDIFF(MONTH, dr, datevisit) < 42) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g3,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 42 AND DATEDIFF(MONTH, dr, datevisit) < 48) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g3_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 48 AND DATEDIFF(MONTH, dr, datevisit) < 60) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g4,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 60 AND DATEDIFF(MONTH, dr, datevisit) < 72) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g5,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 72 AND DATEDIFF(MONTH, dr, datevisit) < 84) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 84 AND DATEDIFF(MONTH, dr, datevisit) < 96) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g7,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 96 AND DATEDIFF(MONTH, dr, datevisit) < 108) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g8,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 108 AND DATEDIFF(MONTH, dr, datevisit) < 156) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g9,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 156 AND DATEDIFF(MONTH, dr, datevisit) < 192) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g13,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 192 AND DATEDIFF(MONTH, dr, datevisit) < 204) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g16,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 204 AND DATEDIFF(MONTH, dr, datevisit) < 216) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g17,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 216 AND DATEDIFF(MONTH, dr, datevisit) < 227) and RSLT in (318,322,328,333,338,344,348) THEN 1 ELSE 0 END) AS g18

 ,SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 12 AND DATEDIFF(MONTH, dr, datevisit) < 18) AND RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g1, 
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 18 AND DATEDIFF(MONTH, dr, datevisit) < 21) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g1_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 21 AND DATEDIFF(MONTH, dr, datevisit) < 24) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g1_9,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 24 AND DATEDIFF(MONTH, dr, datevisit) < 30) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g2,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 30 AND DATEDIFF(MONTH, dr, datevisit) < 36) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g2_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 36 AND DATEDIFF(MONTH, dr, datevisit) < 42) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g3,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 42 AND DATEDIFF(MONTH, dr, datevisit) < 48) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g3_6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 48 AND DATEDIFF(MONTH, dr, datevisit) < 60) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g4,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 60 AND DATEDIFF(MONTH, dr, datevisit) < 72) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g5,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 72 AND DATEDIFF(MONTH, dr, datevisit) < 84) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g6,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 84 AND DATEDIFF(MONTH, dr, datevisit) < 96) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g7,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 96 AND DATEDIFF(MONTH, dr, datevisit) < 108) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g8,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 108 AND DATEDIFF(MONTH, dr, datevisit) < 156) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g9,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 156 AND DATEDIFF(MONTH, dr, datevisit) < 192) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g13,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 192 AND DATEDIFF(MONTH, dr, datevisit) < 204) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g16,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 204 AND DATEDIFF(MONTH, dr, datevisit) < 216) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g17,
	   SUM(CASE WHEN (DATEDIFF(MONTH, dr, datevisit) >= 216 AND DATEDIFF(MONTH, dr, datevisit) < 227) and RSLT in (319,323,329,334,339,345,349) THEN 1 ELSE 0 END) AS g18


From PacientVisit pv
Join ReestrMedOrgDb r on pv.ReestrMedOrgID = r.ID
--Where pv.ReestID = @p and pv.ConditionHelp = 3
Where 
pv.ConditionHelp = 3 and 
r.R_MONTH in (9) AND R.R_YEAR = 2014
AND [OsobSluch] IN (11,12)
--(r.R_MONTH >= @M1 and r.R_YEAR >= @Y1) and (r.R_MONTH <= @M2 and r.R_YEAR <= @Y2)
--ReestrMedOrgID IN (999999999)