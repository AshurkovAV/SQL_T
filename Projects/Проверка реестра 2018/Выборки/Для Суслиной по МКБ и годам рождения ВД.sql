DECLARE @schetTab TABLE (id INT)
INSERT INTO @schetTab(id)VALUES(3032)
--INSERT INTO @schetTab(id)VALUES(2865)
SELECT 
p.W, --YEAR(DR)dr, 
CASE WHEN YEAR(DR) BETWEEN 1983 AND 2001 THEN '1983 AND 2001'
	WHEN YEAR(DR) BETWEEN 1959 AND 1982 THEN '1959 AND 1982' 
	WHEN YEAR(DR) BETWEEN 1920 AND 1958 THEN '1920 AND 1958'
ELSE 'Что-то пошло не так' END [Группа], ds.DS1
FROM D3_ZSL_OMS AS dz
JOIN D3_PACIENT_OMS AS p ON dz.D3_PID = p.ID
LEFT JOIN (SELECT * FROM D3_SL_OMS AS ds WHERE ds.PROFIL = 97) AS ds ON dz.ID = ds.D3_ZSLID
WHERE dz.D3_SCID IN (SELECT id FROM @schetTab)  AND  OS_SLUCH_REGION in (47,49)
AND dz.PR_NOV = 0
AND (YEAR(DR) BETWEEN 1982 AND 2001 OR YEAR(DR) BETWEEN 1959 AND 1982 OR YEAR(DR) BETWEEN 1920 AND 1958)





--DECLARE @ID INT = 2152 --id счета
--SELECT 
--p.W, --YEAR(DR)dr, 
--CASE WHEN YEAR(DR) BETWEEN 1983 AND 2001 THEN '1983 AND 2001'
--	WHEN YEAR(DR) BETWEEN 1959 AND 1982 THEN '1959 AND 1982' 
--	WHEN YEAR(DR) BETWEEN 1920 AND 1958 THEN '1920 AND 1958'
--ELSE 'Что-то пошло не так' END [Группа], ds.DS1, 
--(SELECT v.NameWithID FROM V009 AS v WHERE v.IDRMP = dz.RSLT)
--FROM D3_ZSL_OMS AS dz
--JOIN D3_PACIENT_OMS AS p ON dz.D3_PID = p.ID
--LEFT JOIN (SELECT * FROM D3_SL_OMS AS ds WHERE ds.PROFIL = 97) AS ds ON dz.ID = ds.D3_ZSLID
--WHERE MONTH(dz.DATE_Z_2) = 6 
--AND  OS_SLUCH_REGION in (47,49)
--AND (YEAR(DR) BETWEEN 1982 AND 2001 OR YEAR(DR) BETWEEN 1959 AND 1982 OR YEAR(DR) BETWEEN 1920 AND 1958)
