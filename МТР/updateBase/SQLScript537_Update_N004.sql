BEGIN TRAN
BEGIN TRY
DECLARE @ErrorMessage NVARCHAR(4000)
		DECLARE @ErrorSeverity INT
		DECLARE @ErrorState INT
		
EXEC [dbo].[versionСheck] 536	
--DECLARE @NsiAct-------------------------------------------------------------------------------------------
	declare @NsiAct table 
			(
				ID_N numeric(4,0),DS_N nvarchar(3),KOD_N nvarchar(5),N_NAME nvarchar(300),DATEBEG date,DATEEND date
			)

insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('1','C16','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('2','C16','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('3','C16','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('4','C16','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('5','C16','N3','7 и более пораженных лимфатических узлов','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('6','C16','N3a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('7','C16','N3b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('8','C56','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('9','C56','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('10','C56','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('11','C18','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('12','C18','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('13','C18','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('14','C18','N1a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('15','C18','N1b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('16','C18','N1c',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('17','C18','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('18','C18','N2a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('19','C18','N2b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('20','C19','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('21','C19','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('22','C19','N1','Метастазы в 1-3 (включительно) регионарных лимфатических узлах','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('23','C19','N1a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('24','C19','N1b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('25','C19','N1c',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('26','C19','N2','Метастазы в более чем 3-х регионарных лимфатических узлах','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('27','C19','N2a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('28','C19','N2b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('30','C22','Nx','Недостаточно данных для оценки регионарных лимфатических узлов','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('31','C22','N0','Нет признаков метастатического поражения регионарных лимфатических узлов','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('32','C22','N1','Имеется поражение регионарных лимфатических узлов метастазами','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('33','C25','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('34','C25','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('35','C25','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('36','C43','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('37','C43','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('38','C43','N1','Метастаз в 1 регионарном лимфатическом узле.','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('39','C43','N1a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('40','C43','N1b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('41','C43','N2','Метастазы в 2-3 регионарных лимфатических узлах или только сателлитные или транзитные метастазы','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('42','C43','N2a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('43','C43','N2b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('44','C43','N2c',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('45','C43','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('46','C44','Nx',NULL,'20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('47','C44','N0',NULL,'20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('48','C44','N1',NULL,'20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('49','C44','N2',NULL,'20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('50','C44','N3',NULL,'20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('51','C53','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('52','C53','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('53','C53','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('54','C54','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('55','C54','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('56','C61','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('57','C61','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('58','C61','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('59','C64','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('60','C64','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('61','C64','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('62','C64','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('63','C67','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('64','C67','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('65','C67','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('66','C67','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('67','C67','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('68','C73','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('69','C73','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('70','C73','N1','Имеется поражение регионарных лимфатических узлов метастазами','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('71','C73','N1a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('72','C73','N1b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('73','C20','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('74','C20','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('75','C20','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('76','C20','N1a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('77','C20','N1b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('78','C20','N1c',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('79','C20','N2','Метастазы в более чем 3-х регионарных лимфатических узлах','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('80','C20','N2a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('81','C20','N2b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('82','C15','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('83','C15','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('84','C15','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('85','C15','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('86','C34','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('87','C34','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('88','C34','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('89','C34','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('90','C34','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('91','C32','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('92','C32','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('93','C32','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('94','C32','N2','Метастазы в одном лимфатическом узле на стороне поражения до 6 см. в наибольшем измерении, или метастазы в нескольких лимфатических узлах на стороне поражения до 6  см в наибольшем измерении, или метастазы в лимфатических узлах шеи с обеих сторон до 6 см в наибольшем измерении','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('95','C32','N2a',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('96','C32','N2b',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('97','C32','N2c',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('98','C32','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('99',NULL,'Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('100',NULL,'N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('101',NULL,'N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('102',NULL,'N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('103',NULL,'N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('104','C97','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('105','C81','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('106','C82','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('107','C83','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('108','C84','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('109','C85','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('110','C86','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('111','C88','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('112','C90','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('113','C91','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('114','C92','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('115','C93','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('116','C94','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('117','C95','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('118','C96','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('119','C70','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('120','C71','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('121','C72','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('122','C69','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('123','C69','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('124','C69','Нет',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('125','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('126','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('127','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('128','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('129','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('130','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('131','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('132','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('133','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('134','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('135','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('136','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('137','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('138','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('139','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('140','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('141','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('142','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('143','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('144','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('145','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('146','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('147','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('148','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('149','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('150','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('151','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('152','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('153','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('154','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('155','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('156','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('157','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('158','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('159','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('160','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('161','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('162','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('163','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('164','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('165','C44','Nx',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('166','C44','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('167','C44','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('168','C44','N2',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('169','C44','N3',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('170','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('171','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('172','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('173','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('174','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('175','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('176','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('177','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('178','D04','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('179','D00','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('180','D00','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('181','D01','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('182','D02','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('183','D06','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('184','D07','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('185','D09','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('186','D01','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('187','D01','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('188','D01','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('189','D03','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('190','D05','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('191','C50','N0',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('192','C50','N1',NULL,'20180901',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('193','C50','N2','Метастазы в подмышечных лимфатических узлах на стороне поражения, спаянные между собой или фиксированные, либо клинически определяемые метастазы во внутригрудные лимфатические узлы при отсутствии клинически явного поражения подмышечных лимфатических узлов;','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('194','C50','N3','Метастазы в подключичных лимфатических узлах на стороне поражения, либо клинически определяемые метастазы во внутригрудных лимфатических узлах при наличии клинически явного поражения подмышечных лимфатических узлов, либо метастазы в надключичные лимфатические узлы на стороне поражения (независимо от','20180901','20181231')
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('195','C50','Nx',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('196','C54','Nx',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('197','C15','Nx',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('198','C80','Нет',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('199','C22','Nx',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('200','C22','N0',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('201','C22','N1',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('202','C64','Нет',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('203','C50','N2a',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('204','C50','N2b',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('205','C50','N3a',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('206','C50','N3b',NULL,'20181201',NULL)
insert into @NsiAct (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND) values ('207','C50','N3c',NULL,'20181201',NULL)
--INSERT NEW INTO  NsiCur------------------------------------------------------------------------------------------------------------
	insert into N004 (ID_N,DS_N,KOD_N,N_NAME,DATEBEG,DATEEND)
	select 
	NsiAct.ID_N,NsiAct.DS_N,NsiAct.KOD_N,NsiAct.N_NAME,NsiAct.DATEBEG,NsiAct.DATEEND
	from @NsiAct NsiAct
		left join N004 NSiCur
			on NSiCur.ID_N=NsiAct.ID_N
	where 
		NSiCur.ID_N is null

--UPDATE NsiCur------------------------------------------------------------------------------------------------------------
	update NsiCur set
NsiCur.DATEBEG=NsiAct.DATEBEG,
NsiCur.DATEEND=NsiAct.DATEEND,
NsiCur.ID_N=NsiAct.ID_N,
NsiCur.DS_N=NsiAct.DS_N,
NsiCur.KOD_N=NsiAct.KOD_N,
NsiCur.N_NAME=NsiAct.N_NAME
	from @NsiAct NsiAct
		inner join N004 NsiCur
						on NSiCur.ID_N=NsiAct.ID_N
	where
		isnull(NsiCur.DATEBEG,'19000101')<>isnull(NsiAct.DATEBEG,'19000101') or
isnull(NsiCur.DATEEND,'19000101')<>isnull(NsiAct.DATEEND,'19000101') or
isnull(NsiCur.ID_N,'0')<>isnull(NsiAct.ID_N,'0') or
isnull(NsiCur.DS_N,'')<>isnull(NsiAct.DS_N,'') or
isnull(NsiCur.KOD_N,'')<>isnull(NsiAct.KOD_N,'') or
isnull(NsiCur.N_NAME,'')<>isnull(NsiAct.N_NAME,'') 

EXEC [dbo].[versionUpdate] 537
COMMIT TRAN;		
END TRY
		BEGIN CATCH			
			SET @ErrorMessage= ERROR_MESSAGE()
			SET @ErrorSeverity= ERROR_SEVERITY()
			SET @ErrorState= ERROR_STATE()
			RAISERROR (@ErrorMessage,@ErrorSeverity,@ErrorState)
			IF (@@trancount > 0) ROLLBACK TRAN						
		END CATCH
IF (@@trancount > 0) ROLLBACK TRAN;

